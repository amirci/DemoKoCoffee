(function(){var t,n=function(n,t){return function(){return n.apply(t,arguments)}};DemoKoCoffee.MovieLibraryViewModel=function(){function i(i){this.cancelEditing=n(this.cancelEditing,this);this.saveEditing=n(this.saveEditing,this);this.editTitle=n(this.editTitle,this);this.newMovie=n(this.newMovie,this);this.loadMovies=n(this.loadMovies,this);var r=this;this.title=ko.observable(i);this.movies=ko.observableArray();this.editingTitle=ko.observable(!1);this.newTitle=ko.observable();this.count=ko.computed(function(){return r.movies().length});this.newMovieVM=new t(this.movies);this.loadMovies()}return i.prototype.loadMovies=function(){return DemoKoCoffee.Movie.all({success:this.movies,error:function(){return console.log("Error loading movies!")}})},i.prototype.newMovie=function(){return this.newMovieVM.active(!0)},i.prototype.editTitle=function(){return this.newTitle(this.title()),this.editingTitle(!0)},i.prototype.saveEditing=function(){return this.title(this.newTitle()),this.editingTitle(!1)},i.prototype.cancelEditing=function(){return this.editingTitle(!1)},i}();t=function(){function t(t){this.movies=t;this.cancel=n(this.cancel,this);this.save=n(this.save,this);this.activate=n(this.activate,this);this.active=ko.observable(!1);this.title="";this.relDate="";this.active.subscribe(this.activate)}return t.prototype.activate=function(n){if(n)return this.relDate=this.title=""},t.prototype.save=function(){var n=this;return this.active(!1),DemoKoCoffee.Movie.create({movie:{title:this.title,releaseDate:this.relDate},success:function(t){return n.movies.push(t)},error:function(){return console.log("An error ocurred trying to add the movie")}})},t.prototype.cancel=function(){return this.active(!1)},t}()}).call(this)